function [datoteke] = iskanje (dir, iskalniNiz)  %function [datoteke] = iskanje (dir, iskalniNiz) odpre mapo dir, poisce notri vse dokumente in vrne  %tiste dokumente v katerem je iskalniNiz najpogosteje zastopan  %C:\Users\Melanija\Desktop\Gradiva\4 semestar\MM\PROJEKT\Stories    FILES = readdir(dir);  FILES = FILES(3:end)  stDokumentov = length(FILES);    %iskanje vseh besed v vseh dokumentih  vseBesede = [];  for i = 1:stDokumentov    path = strcat(dir,"/",FILES(i));    a = fileread([path{:}]);    a = strrep(a, ',', '');    a = strrep(a, '.', '');    a = strrep(a, '?', '');    a = strrep(a, '!', '');    a = strsplit(a);    a = tolower(a);    vseBesede = [vseBesede, a];  endfor  vseBesede = unique(vseBesede);  stRazlicnihBesed=length(vseBesede);    %izpopolnitev matrike A  A = zeros(stRazlicnihBesed, stDokumentov);  for i = 1:stDokumentov    path = strcat(dir,"/",FILES(i));    a = fileread([path{:}]);    a = strrep(a, ',', '');    a = strrep(a, '.', '');    a = strrep(a, '?', '');    a = strrep(a, '!', '');    a = strsplit(a);    a = tolower(a);    stBesedDokumenta = length(a);    for j = 1:stBesedDokumenta      beseda = a(1,j);      [v, s]= find(strcmp(vseBesede,beseda));      A(s, i)++;    endfor     endfor   %izboljsava matrike A  gf = zeros(stRazlicnihBesed, 1);  for i = 1:stRazlicnihBesed    gf(i,1) = sum(A(i,:),2);  end  A;  gf;  G = zeros(rows(A),1);  L = log(A+1);  for i = 1:stRazlicnihBesed    vsota = 0;    for j = 1:stDokumentov      pij = A(i,j)/gf(i);      if (pij == 0 || pij == NaN)        pij = 1;       end      vsota+= ((pij*log(pij))/log(stDokumentov));    end    G(i) = 1-vsota;  end    A=L.*G;  [U,S,V] = svd(A, "econ");    k = rows(S);  if (k > 100)    k = 100;  end    U = U(:, 1:k);  S = S(1:k, 1:k);  V = V(1:k, :);    %besede v iskalnem nizu zamenjamo z indeksi iz vseh besed  iskalniNiz = strsplit(iskalniNiz);  iskalniNiz = tolower(iskalniNiz);  q = zeros(stRazlicnihBesed,1);  for i = 1:length(iskalniNiz)    [v, s]= find(strcmp(vseBesede,iskalniNiz(i)));    if (rows(s) == 0)       continue;    else      q(s)++;    endif  endfor    Lq = log(q+1);  q=Lq.*G;  q;    %iskalni q  q1 = q'*U*pinv(S);  %racunanje razdalje med q1 in stolpci matrike V  kosinusi = zeros(1, columns(V));  %da ne bomo vsakic racunali  dq1=norm(q1);  V = V';  for i=1:columns(V)    if(dq1 == 0)       break;    end    stolpec = V(:,i);    kosinus = dot(q1,stolpec)/(dq1*norm(stolpec));    kosinusi(1,i) = kosinus;  endfor  kosinusi  [x,ix] = max(kosinusi);  ii = find(kosinusi>=0.5);  if (x != 0)    datoteke = FILES(ii);    %datoteke = FILES(ix);  else    datoteke = [];  end    
endfunction
